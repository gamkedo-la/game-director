<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
</head>
<body>
	<script src="Story.js"></script>
	<script src="StoryCards.js"></script>
	<script src="StoryEditor.js"></script>
	<script src="loading.js"></script>
	<script src="graphics.js"></script>
	<script src="main.js"></script>
	<script type="text/javascript">
		const StatsX = 64;
		const StatsY = 32;
		window.onload = function(){
			window.addEventListener('keydown',keyDown,true);
		}

		function keyDown(evt){
			if(evt.keyCode == 49){
				if(activeCard.active){
					selectYes();
					outputText.text = activeCard.yesResponse;
				} else{
					flipCard();
					outputText.text = activeCard.question;
				}
			}

			if(evt.keyCode == 50){
				if(activeCard.active){
					selectNo();
					outputText.text = activeCard.noResponse;
				} else{
					flipCard();
					outputText.text = activeCard.question;
				}
			}

		}
		flipCard();

		var statBar1 = createDisplayObject();
		statBar1.draw = function(){
			print("MORALE", StatsX, StatsY - 50, 20, "white", 20, "Helvetica");
			rect(StatsX,StatsY,128,16,4,"white");
			rectFill(StatsX,StatsY,128 * (stats.energy/100),16,"white");
		}

		var statBar2 = createDisplayObject();
		statBar2.draw = function(){
			print("QUALITY", StatsX, StatsY*3 - 50, 20, "white", 20, "Helvetica");
			rect(StatsX,StatsY*3,128,16,4,"white");
			rectFill(StatsX,StatsY*3,128 * (stats.quality/100),16,"white");
		}

		var statBar3 = createDisplayObject();
		statBar3.draw = function(){
			print("SCHEDULE", StatsX, StatsY*5 - 50, 20, "white", 20, "Helvetica");
			rect(StatsX,StatsY*5,128,16,4,"white");
			rectFill(StatsX,StatsY*5,128 * (stats.time/100),16,"white");
		}

		var statBar4 = createDisplayObject();
		statBar4.draw = function(){
			print("BUDGET", StatsX, StatsY*7 - 50, 20, "white", 20, "Helvetica");
			rect(StatsX,StatsY*7,128,16,4,"white");
			rectFill(StatsX,StatsY*7,128 * (stats.budget/100),16,"white");
		}

		var weekCounter = createDisplayObject();
		weekCounter.draw = function(){
			print("WEEK: " + turn, 800, StatsY - 50, 55, "white", 20, "Helvetica");
		}

		var cardFrame = createDisplayObject();
		cardFrame.width = 512;
		cardFrame.height = 720;
		cardFrame.draw = function(){
			rectFill(canvasWidth/2 - (this.width/2), 0, this.width, this.height, "white");
		}

		var cardImage = createDisplayObject();
		cardImage.width = 384;
		cardImage.height = 384;
		cardImage.x = (canvasWidth/2) - (cardImage.width/2);
		cardImage.y = (canvasHeight/2) - (cardImage.height * 0.6);
		cardImage.draw = function(){
			switch(activeCard.author){
				case "PROGRAMMER": 
					spr(assets["images/programmer.png"],this.x,this.y)
					break;
				case "ARTIST":
					spr(assets["images/artist.png"],this.x,this.y)
					break;
				case "DESIGNER":
					spr(assets["images/designer.png"],this.x,this.y)
					break;
				case "PRODUCER":
					spr(assets["images/producer.png"],this.x,this.y)
					break;
				case "SOUND DESIGNER":
					spr(assets["images/sound_engineer.png"],this.x,this.y)
					break;
			}
			
			//rectFill(this.x, this.y, this.width, this.height, "#fff6d3");
		}

		var outputText = createDisplayObject();
		outputText.text = activeCard.question;
		outputText.draw = function(){
			print(outputText.text, cardImage.x, 40, 384, "black", 20, "Helvetica");
		}

		var yesChoiceText = createDisplayObject();
		yesChoiceText.draw = function(){
			if(activeCard.active){
				print("1. " + activeCard.yesAnswer, cardImage.x, cardImage.y + cardImage.height + 80, "black", 20, "Helvetica");
			}
		}

		var noChoiceText = createDisplayObject();
		noChoiceText.draw = function(){
			if(activeCard.active){
				print("2. " + activeCard.noAnswer, cardImage.x, cardImage.y + cardImage.height + 120, "black", 20, "Helvetica");
			}	
		}

	</script>

</body>
</html>